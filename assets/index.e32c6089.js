(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=n(e);fetch(e.href,s)}})();localStorage.getItem("page")||localStorage.setItem("page",1);const p=document.querySelectorAll(".pagination-link");p.forEach(t=>{t.textContent!=="\u041D\u0430\u0437\u0430\u0434"&&t.textContent!=="\u0412\u043F\u0435\u0440\u0435\u0434"&&t.textContent===localStorage.getItem("page")&&t.classList.add("pagination-active")});const d="0edcf27d-cd4f-4f58-aedc-0c6ec6c354aa",f="https://kinopoiskapiunofficial.tech/api/v2.2/films/top?type=TOP_250_BEST_FILMS&page=",u="https://kinopoiskapiunofficial.tech/api/v2.2/films/",a=document.querySelector(".movies"),c=document.querySelector(".popup"),r=document.querySelector(".popup-body");function g(t){a.innerHTML="",t.films.forEach(o=>{let n;+o.rating>=7?n="green":+o.rating>=4?n="yellow":+o.rating<4&&(n="red");const i=document.createElement("div");i.classList.add("movie","flex","flex-col","bg-[#161c29]","gap-2","rounded","p-2","opacity-80","hover:opacity-60","cursor-pointer","relative"),i.setAttribute("id",o.filmId),i.innerHTML=`<img src='${o.posterUrl}' alt='${o.nameRu}' class='rounded'>
				<h4 class='text-slate-200'>${o.nameRu}</h4>
				<span class='text-main-blue text-sm'>${o.genres.map(e=>` ${e.genre}`)}</span>
				<div class='absolute top-4 left-4 ${n} md:p-2 p-1 rounded'>${o.rating}</div>`,a.append(i)})}async function m(t,o){let n=t+o;const e=await(await fetch(n,{headers:{"Content-Type":"application/json","X-API-KEY":d}}).catch(s=>{console.log(s)})).json();g(e)}a.addEventListener("click",t=>{t.target.closest(".movie")&&(c.classList.add("open"),document.body.style.overflow="hidden",y(t.target.parentElement.getAttribute("id")))});document.body.addEventListener("click",t=>{t.target.closest(".popup-close")&&(c.classList.remove("open"),document.body.style.overflow="auto")});document.body.addEventListener("click",t=>{t.target.closest(".popup-body")&&(t.target.closest(".popup-content")||(c.classList.remove("open"),document.body.style.overflow="auto"))});async function y(t){let o=u+t;const i=await(await fetch(o,{headers:{"Content-Type":"application/json","X-API-KEY":d}}).catch(e=>{console.log(e)})).json();v(i)}function v(t){let o,n=t.ratingKinopoisk,i=t.nameOriginal?t.nameOriginal:t.nameRu;o=n>=7?"green":o=n<7&&n>=4?"yellow":"red",r.innerHTML="";const e=document.createElement("div");e.classList.add("popup-content"),e.innerHTML=`
		<button class='popup-close btn self-start'>\u0417\u0430\u043A\u0440\u044B\u0442\u044C</button>
			<div class='film-info w-full'>
				<img src='${t.posterUrl}' alt='' class='max-w-sm rounded'>
				<h3 class='text-3xl font-bold'>${t.nameRu}<span>(${t.year})</span></h3>
				<div class='text-sm text-gray-500 mr-4'>${i}<span class='ml-2 rounded p-1 ${o} text-white'>${t.ratingKinopoisk}</span></div>
				<div class='info-text w-full pt-7'>
					<div class='flex justify-between px-4'><div class='w-[142px] gap-12'>\u0413\u043E\u0434 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u0434\u0441\u0442\u0432\u0430</div> <div class='opacity-60 self-end'>${t.year}</div></div>
					<div class='flex justify-between px-4'><div class='w-[142px] gap-12'>\u0416\u0430\u043D\u0440</div> <div class='opacity-60 self-end'>${t.genres[0].genre}</div></div>
					<div class='flex justify-between px-4'><div class='w-[142px] gap-12'>\u0421\u0442\u0440\u0430\u043D\u0430</div> <div class='opacity-60 self-end'>${t.countries[0].country}</div></div>
				</div>
				<div class='self-start mt-4'>
					<h2>\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0444\u0438\u043B\u044C\u043C\u0430</h2>
					<div class='text-white opacity-60'>${t.description}</div>
				</div>
			</div>`,r.append(e)}m(f,localStorage.getItem("page"));const h=document.querySelector(".pagination");h.addEventListener("click",t=>{t.target.closest("a")&&(t.target.textContent!=="\u041D\u0430\u0437\u0430\u0434"?t.target.textContent!=="\u0412\u043F\u0435\u0440\u0435\u0434"?localStorage.setItem("page",t.target.textContent):+localStorage.getItem("page")!=13&&localStorage.setItem("page",+localStorage.getItem("page")+1):+localStorage.getItem("page")!=1&&localStorage.setItem("page",+localStorage.getItem("page")-1)),location.reload(),t.preventDefault()});
